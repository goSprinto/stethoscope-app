organization: Sprinto
version: "1.0"
policyFormat: "1.0"

strings:
  ok: This device is properly configured
  warning: >
    The security settings on this device could be improved.
    Click the arrow next to each recommendation for instructions.
  critical: >
    The security settings on this device should be improved.
    Click the arrow next to each recommendation for instructions.
  policyDescription: baseline policy
  rescanButton: Rescan
  lastScan: Last scanned

practices:
  firewall:
    title: >
      Your Firewall should be enabled
    subTitle: >
      {{#if passing}}
        Your Firewall is enabled
      {{else}}
        Your Firewall should be enabled
      {{/if}}
    shortDescription: >
      {{#if passing}}
        Your Firewall is enabled
      {{else}}
        Your Firewall is not enabled
      {{/if}}
    description: >
      Firewalls control network traffic into and out of a system. Enabling the firewall on your device can prevent network-based attacks on your system, and is especially important if you make use of insecure wireless networks (such as at coffee shops and airports).
    directions:
      darwin: |
        1. Choose System Preferences from the Apple menu.
        1. Click [Security or Security & Privacy](x-apple.systempreferences:com.apple.preference.security).
        1. Click the [Firewall](x-apple.systempreferences:com.apple.preference.security?Firewall) tab.
        1. Unlock the pane by clicking the lock in the lower-left corner and enter the administrator username and password.
        1. Click "Turn On Firewall" or "Start" to enable the firewall.
        1. Click Advanced to customize the firewall configuration.
        1. Rescan to update the status

      win32: |
        1. Open [Windows Firewall Settings](ps://wf.msc)
        1. Click "Windows Defender Firewall Properties" in the center pane
        1. Ensure "Firewall state" is set to "On (recommended)" on the Domain, Public, and Private Profile tabs
        1. Click OK
        1. Rescan to update the status
      linux: |
        1. Open a terminal.
        1. Enter the command: "sudo ufw enable".
        1. Rescan to update the status
  stethoscopeVersion:
    title: >
      {{appName}} updated
    subTitle: >
      {{#if passing}}
        {{appName}} is up to date
      {{else}}
        {{appName}} needs to be updated
      {{/if}}
    shortDescription: >
      {{#if passing}}
        {{appName}} is up to date
      {{else}}
        {{appName}} is not updated
      {{/if}}
    description: >
      Keeping the app up to date gives you access to the latest features, security patches, and performance improvements.
    directions:
      darwin: |
        <a href='{{appName}}://update' class="btn">Update {{appName}}</a>
      win32: |
        <a href='{{appName}}://update' class="btn">Update {{appName}}</a>.
      linux: |
        <a href='{{appName}}://update' class="btn">Update {{appName}}</a>.
  remoteLogin:
    title: >
      Remote Login should be disabled
    subTitle: >
      {{#if passing}}
        Remote Login is disabled
      {{else}}
        Remote Login should be disabled
      {{/if}}
    shortDescription: >
      {{#if passing}}
        Remote Login is disabled
      {{else}}
        Remote Login is not disabled
      {{/if}}
    description: >
      The 'Remote Login' setting on your device controls whether users can login remotely to the system. If you don't know what this is or why you would want it, you should disable 'Remote Login'.
    directions:
      darwin: |
        1. Choose System Preferences from the Apple menu.
        1. Click [Sharing](x-apple.systempreferences:com.apple.preferences.sharing?Services_RemoteLogin).
        1. Uncheck "Remote Login" on the left.
        1. Rescan to update the status

      win32: |
        1. Open [Advanced System Preferences](ps://SystemPropertiesRemote).
        1. Under "Remote Desktop" heading, select "Don't allow remote connections to this computer".
        1. Click Apply.
        1. Click OK.
        1. Rescan to update the status
  diskEncryption:
    title: >
      Disk encryption
    subTitle: >
      {{#if passing}}
        Disk encryption is enabled
      {{else}}
        Disk encryption is not enabled
      {{/if}}
    shortDescription: >
      {{#if passing}}
        Disk encryption is enabled
      {{else}}
        Disk encryption is not enabled
      {{/if}}
    description: >
      Full-disk encryption protects data at rest from being accessed by a party who does not know the password or decryption key. Systems containing internal data should be encrypted. It is every employee's responsibility to keep internal data safe.
    directions:
      darwin: |
        {{#if venturaOrLater}}
        1. Choose System Preferences from the Apple menu.
        1. Click [Privacy & Security](x-apple.systempreferences:com.apple.preference.security).
        1. Scroll down and look for the FileVault card.
        1. To begin the procedure, click the "Turn On" button on the card.
        1. Rescan to update the status
        {{else}}
        1. Choose System Preferences from the Apple menu.
        1. Click [Security or Security & Privacy](x-apple.systempreferences:com.apple.preference.security).
        1. Click the [FileVault](x-apple.systempreferences:com.apple.preference.security?FDE) tab.
        1. Unlock the pane by clicking the lock in the lower-left corner and enter the administrator username and password.
        1. Click "Turn On FileVault" to start the process.
        1. Rescan to update the status
        {{/if}}
        {{#each disks}}
          <li>
            {{#if this.encrypted}}
              {{{okIcon this.label}}}
            {{else}}
              {{{warnIcon this.label}}}
            {{/if}}
          </li>
        {{/each}}

      win32: |
        1. Open the Start menu and search for "BitLocker."
        1. Select "Manage BitLocker" from the search results.
        1. Open BitLocker Drive Encryption
        1. Click "Turn on BitLocker".
        1. Rescan to update the status

      linux: |
        The recommended option for full disk encryption for Linux is <a target="_blank" href="https://gitlab.com/cryptsetup/cryptsetup/-/wikis/home">LUKS</a>. You can find instructions for Ubuntu 19.04 and 20.04 below.
        1. <a target="_blank" href="https://medium.com/@chrishantha/encrypting-disks-on-ubuntu-19-04-b50bfc65182a">Ubuntu 19.04</a>
        1. <a target="_blank" href="https://gist.github.com/luispabon/db2c9e5f6cc73bb37812a19a40e137bc">Ubuntu 21.04 dual boot with Windows 10</a>

        For other distributions, please consult the documentation.
  automaticUpdates:
    title: >
      Automatic Updates should be enabled
    subTitle: >
      {{#if passing}}
        Automatic Updates are enabled
      {{else}}
        Automatic Updates should be enabled
      {{/if}}
    shortDescription: >
      {{#if passing}}
        Automatic Updates are enabled
      {{else}}
        Automatic Updates should be enabled
      {{/if}}
    description: >
      One of the most important things you can do to secure your device(s) is to keep your operating system and software up to date. New vulnerabilities and weaknesses are found every day, so frequent updates are essential to ensuring your device(s) include the latest fixes and preventative measures. Enabling automatic updating helps ensure your machine is up to date without having to manually install updates.
    directions:
      darwin: |
        1. Choose System Preferences from the Apple menu.
        {{#if mojaveOrLater}}
        1. Click [Software Update](x-apple.systempreferences:com.apple.preferences.softwareupdate)
        {{else}}
        1. Click [App Store](prefs://com.apple.preferences.appstore).
        {{/if}}
        1. Click "Automatically check for updates"
        {{#unless passing}}
          1. Make sure the following are checked:

          - {{{statusIcon automaticCheckEnabled 'Automatically check for updates'}}}
          - {{{statusIcon automaticDownloadUpdates 'Download new updates when available'}}}
          - {{{statusIcon automaticOsUpdates 'Install macOS updates'}}}
          - {{{statusIcon automaticAppUpdates 'Install app updates from the App Store'}}}
          - {{{statusIcon automaticSecurityUpdates 'Install system data files and \*security updates\*'}}}
        {{/unless}}
        1. Rescan to update the status

      win32: |
        1. Open [Services](ps://services.msc) (Start > Run > services.msc).
        1. Scroll down to find "Windows Update" and double-click the name.
        1. Change "Startup Type" from "DISABLED" to "MANUAL" or "AUTOMATIC".
        1. Click "Apply".
        1. Click "OK".
        1. Rescan to update the status

        If you manually disabled Windows Update using Group Policy Editor:

        1. Open [Local Group Policy Editor](ps://gpedit.msc) (Start > Run > gpedit.msc)
        1. Expand: Computer Configuration > Administrative Templates > Windows Components > Windows Update
        1. Find and double-click on "Configure Automatic Updates"
        1. Select "Enabled" or "Not Configured" to turn automatic updates back on
        1. Rescan to update the status
  screenLock:
    title: >
      Screen lock
    subTitle: >
      {{#if passing}}
        Screen lock is enabled
      {{else}}
        Screen lock is disabled
      {{/if}}
    shortDescription: >
      {{#if passing}}
        Screen lock enabled for {{this.screenLockDelay}}
      {{else}}
        Automatic Updates should be enabled
      {{/if}}
    description: >
      Screen locks, or screen saver locks, prevent unauthorized third-parties from accessing your laptop when unattended by requiring a password to dismiss the screen saver or wake from "sleep" mode.
    directions:
      darwin: |
        {{#if venturaOrLater}}
        1. Choose System Preferences from the Apple menu.
        1. Select [Lock Screen](x-apple.systempreferences:com.apple.Lock-Screen-Settings.extension)
        1. Set the “Require password after screen saver begins or display is turned off” pull-down menu to "immediately".
        1. Rescan to update the status
        {{else}}
        1. Choose System Preferences from the Apple menu.
        1. Click [Security or Security & Privacy](x-apple.systempreferences:com.apple.preference.security).
        1. Select the [General](x-apple.systempreferences:com.apple.preference.security?General) tab.
        1. Unlock the pane by clicking the lock in the lower-left corner and enter the administrator username and password.
        1. Check the "Require password" box and set the pull down menu to to "immediately" after sleep or screen saver begins.
        1. Rescan to update the status
        {{/if}}
      win32: |
        1. Open [Lock screen settings](ms-settings:lockscreen).
        1. Scroll down and click on "Screen saver settings".
        1. Select a screen saver of your choice and a wait time of less than 15 minutes.
        1. Select the option "On resume, display logon screen".
        1. Rescan to update the status
      linux: |
        **Ubuntu 18.04**

        1. From the upper-right drop-down menu, click the Settings icon.
        1. In the left-hand pane, select Privacy.
        1. Click on ScreenLock
        1. Ensure that "Automatic Screen Lock" is set to ON.
        1. For "Lock screen after blank for", select "Screen Turns Off".
        1. In the left-hand menu, select Power.
        1. Under Power Saving -> Blank screen, select a value less than 15 minutes.
        1. Rescan to update the status

        **Ubuntu 20.04**

        1. From the upper-right drop-down menu, click the Settings icon.
        1. In the left-hand pane, select Privacy -> Screen Lock.
        1. For "Blank Screen Delay", select a value less than 15 minutes.
        1. Set "Automatic Screen Lock" to ON.
        1. For "Automatic Screen Lock Delay", select "Screen Turns Off".
        1. Set "Lock Screen on Suspend" to ON.
        1. Rescan to update the status
  screenIdle:
    title: >
      Auto lock in 15 minutes
    subTitle: >
      {{#if passing}}
        Screen locks in 15 min is enabled
      {{else}}
        Screen locks in 15 min is disabled
      {{/if}}
    shortDescription: >
      {{#if passing}}
        Screen lock enabled for {{this.screenLockDelay}}
      {{else}}
        Automatic Updates should be enabled
      {{/if}}
    description: >
      Screens which lock automatically when your laptop is unattended prevent unauthorized access from third-parties by requiring a password to dismiss the screen saver or wake from "sleep" mode. Your timeout setting should be 15 minutes or less.
    directions:
      darwin: |
        {{#if venturaOrLater}}
        1. Choose System Preferences from the Apple menu.
        1. Select [Lock Screen](x-apple.systempreferences:com.apple.Lock-Screen-Settings.extension)
        1. Set the “Start Screen Saver When inactive” pull-down menu to 15 minutes or less.
        1. Rescan to update the status
        {{else}}
        1. Choose [System Preferences](x-apple.systempreferences:com.apple.systempreferences) from the Apple menu.
        1. Click Desktop & Screen Saver.
        1. Click the Screen Saver tab.
        1. Adjust the "Start after" dropdown to 15 minutes or less.
        1. Rescan to update the status
        {{/if}}
      linux: |
        ** Ubuntu 18.04 **
        1. From the upper-right drop-down menu, click the Settings icon.
        1. In the left-hand pane, select Privacy.
        1. Click on ScreenLock
        1. For "Lock screen after blank for", select "Screen Turns Off".
        1. In the left-hand menu, select Power.
        1. Under Power Saving -> Blank screen, select a value less than 15 minutes.
        1. Rescan to update the status

        ** Ubuntu 20.04 **
        1. From the upper-right drop-down menu, click the Settings icon.
        1. In the left-hand pane, select Privacy -> Screen Lock.
        1. For "Blank Screen Delay", select a value less than 15 minutes.
        1. For "Automatic Screen Lock Delay", select "Screen Turns Off".
        1. Rescan to update the status

      win32: |
        1. Open [Lock screen settings](ms-settings:lockscreen).
        1. Scroll down and click on "Screen saver settings".
        1. Make sure the wait time is less than or equal to 15 minutes.
        1. Rescan to update the status
  osVersion:
    title: >
      Operating System
    subTitle: >
      {{#if passing}}
        System is up to date
      {{else}}
        System is out of date
      {{/if}}
    shortDescription: >
      {{#if passing}}
        your current Os version - {{this.os.Version}}
      {{else}}
        System is out of date
      {{/if}}
    description: >
      One of the most important things you can do to secure your device(s) is to keep your operating system and software up to date. New vulnerabilities and weaknesses are found every day, so frequent updates are essential to ensuring your device(s) include the latest fixes and preventative measures.
    directions:
      darwin: |
        1. From the Apple menu in the corner of your screen, choose System Preferences.
        1. In the System Preferences window, click Software Update. (If your System Preferences doesn't include Software Update, use the App Store to get updates instead.)
        1. Click Update Now or Upgrade Now.

        For more details, please see Apple help page on <a target="_blank" href="https://support.apple.com/en-in/HT201541">how to update/upgrade MacOS</a>.

        {{requirement "osVersion" "darwin"}}

      win32: |
        1. Open [Windows Update](ms-settings:windowsupdate) in the Settings.
        1. Click "Restart now"

        {{requirement "osVersion" "win32"}}

      linux: |
        1. Open Software Updater.
        1. Install any outstanding updates.
        1. Restart the system if prompted.

        If you don't see any available updates, you may need to upgrade to a release of your distribution that is still supported and is receiving security patches from the vendor.

        {{requirement "osVersion" "linux"}}
  applications:
    title: >
      Applications are not following requirements
    subTitle: >
      {{#if passing}}
        Applications are following requirements
      {{else}}
        Applications are not following requirements
      {{/if}}
    shortDescription: >
      {{#if passing}}
        Applications are following requirements
      {{else}}
        Applications are not following requirements
      {{/if}}
    description: >
      Certain applications have been designated as required or prohibited by your organization. Required applications may also have acceptable versions.
    directions:
      darwin: |
        See the following requirements:

      win32: |
        See the following requirements:
  antivirus:
    title: >
      Antivirus
    subTitle: >
      {{#if passing}}
        Antivirus is running
      {{else}}
        Antivirus is disabled (Optional)
      {{/if}}
    shortDescription: >
      {{#if passing}}
        Antivirus is running
      {{else}}
        Antivirus is not running
      {{/if}}
    description: >
      An antivirus software protects you from viruses, malware and spyware.
      <p class="highlight">If you have access to the company production servers or if you handle customer data, you must have an antivirus software running on your system.</p>
    directions:
      darwin: |
        <ol>
        <li> Please install one of the following:
          <ol>    
          <li> <a target="_blank" href="https://www.avg.com/en-in/avg-antivirus-for-mac#pc">AVG Antivirus</a> [Free]</li>
          <li> <a target="_blank" href="https://home.sophos.com/en-us/download-mac-anti-virus.aspx">Sophos Antivirus</a> [Free]</li>
          <li><a target="_blank" href="https://www.mcafee.com/en-in/antivirus/mac.html">McAfee Endpoint Security for Mac</a></li>
          <li><a target="_blank" href="https://www.clamxav.com/">ClamXAV</a></li>
          </ol>
          </li>
        <li>Rescan to update the status</li>
        </ol>

      win32: |
        <a target="_blank" href="https://support.microsoft.com/en-us/windows/stay-protected-with-windows-security-2ae0363d-0ada-c064-8b56-6a39afb6a963">Enable Windows Defender using these steps</a>

      linux: |
        Please install one of the following:
        1. <a target="_blank" href="https://antivirus.comodo.com/">Comodo Antivirus</a>
        1. <a target="_blank" href="https://www.clamav.net/">Clam Antivirus</a>
        1. <a target="_blank" href="https://www.avg.com/en-us/free-antivirus-download">AVG Antivirus</a>

        **Setting up Clam Antivirus**

        1. sudo apt-get install clamav clamav-daemon
        1. sudo service clamav-freshclam restart (wait for 3-5 minutes)
        1. sudo service clamav-daemon restart && sudo service clamav-daemon status (The output should show the status as running)
  openWifiConnections:
    title: >
      There are open Wi-Fi networks cached locally
    subTitle: >
      {{#if passing}}
        There are no open Wi-Fi networks cached locally
      {{else}}
        There are open Wi-Fi networks cached locally
      {{/if}}
    shortDescription: >
      {{#if passing}}
        There are no open Wi-Fi networks cached locally
      {{else}}
        There are open Wi-Fi networks cached locally
      {{/if}}
    description: >
      Unprotected Wi-Fi networks are a common attack vector for man-in-the-middle attacks. If you connect to an unprotected Wi-Fi hotspot once, your computer will then try to connect to any access point with a matching name in the future. An attacker can then simply spoof that network name and proxy all of the network traffic from the computer.
    directions:
      darwin: |
        1. Choose [System Preferences](x-apple.systempreferences:com.apple.systempreferences) from the Apple menu.
        1. Click Network.
        1. Click on the Wi-Fi connection in the left pane
        1. Click on "Advanced..."
        1. Find and remove the networks that has Security set to "None"
        1. Rescan to update the status
